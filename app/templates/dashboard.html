{% extends "base.html" %}
{% block title %}Dashboard Â· Personalized Learning Recommendation AI{% endblock %}
{% block content %}
  <section class="card">
    <h2>Latest Performance</h2>
    {% if latest_attempt %}
      <p>Attempt completed on {{ latest_attempt['finished_at'] }} with {{ latest_attempt['score_pct'] }}% overall.</p>
      <div class="topic-grid">
        {% for topic, pct in latest_split.items() %}
          <div class="topic-card">
            <h3>{{ topic }}</h3>
            <div class="progress"><span style="width: {{ pct }}%"></span></div>
            <p>{{ pct }}%</p>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>You have not completed an attempt yet. Start the <a href="{{ url_for('quiz') }}">quiz</a> to begin.</p>
    {% endif %}
    <div class="best-summary">
      <h3>Lifetime best by topic</h3>
      <ul>
        {% for topic, pct in best_by_topic.items() %}
          <li>{{ topic }}: {{ pct }}%</li>
        {% endfor %}
      </ul>
    </div>
    {% if unlocked %}
      <div class="notice success">Next recommendation: <strong>Database Development Process</strong>. Keep exploring!</div>
    {% endif %}
  </section>

  <section class="card">
    <h2>Attempt History</h2>
    {% if history %}
      <table class="table">
        <thead>
          <tr><th>Date</th><th>Score %</th></tr>
        </thead>
        <tbody>
          {% for row in history %}
            <tr>
              <td><a href="{{ url_for('review', attempt_id=row['attempt_id']) }}">{{ row['finished_at'] }}</a></td>
              <td>{{ row['score_pct'] }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="muted">No attempts yet.</p>
    {% endif %}
  </section>
{% endblock %}
