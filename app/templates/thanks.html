{% extends 'base.html' %}
{% block title %}End of Prototype{% endblock %}
{% block content %}
<h2>End of Prototype</h2>
<p><strong>Loving the experience ? Let’s take a moment to appreciate the creator & his AI tools. If not, give one star.</strong></p>

<div id="rating-box" class="card" style="padding:1rem;max-width:480px;">
  <div id="stars" style="font-size:28px;cursor:pointer;">
    <span data-val="1">☆</span>
    <span data-val="2">☆</span>
    <span data-val="3">☆</span>
    <span data-val="4">☆</span>
    <span data-val="5">☆</span>
  </div>
  <textarea id="comment" rows="3" style="width:100%;margin-top:.5rem;" placeholder="Optional comment..."></textarea>
  <button id="submitRating" class="btn" style="margin-top:.5rem;">Submit</button>
  <p id="statusMsg" class="muted" style="margin-top:.5rem;"></p>
</div>

<section class="card" style="padding:1rem;opacity:.6;margin-top:1rem;">
  <h3>Next Recommendation</h3>
  <p>This will appear in the full version.</p>
  <button class="btn" disabled>Coming Soon</button>
</section>

<script>
let picked = 0;
const stars = document.querySelectorAll('#stars span');
stars.forEach(s => {
  s.addEventListener('mouseover', () => {
    const v = parseInt(s.dataset.val);
    stars.forEach(x => x.textContent = parseInt(x.dataset.val) <= v ? '★' : '☆');
  });
  s.addEventListener('click', () => { picked = parseInt(s.dataset.val); });
});
document.getElementById('submitRating').addEventListener('click', async () => {
  const comment = document.getElementById('comment').value || '';
  if (!picked) { document.getElementById('statusMsg').textContent = 'Please pick 1-5 stars.'; return; }
  const res = await fetch('/api/feedback', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ rating: picked, comment })});
  const data = await res.json();
  document.getElementById('statusMsg').textContent = data.ok ? 'Thanks for the feedback!' : (data.error || 'Error');
});
</script>
{% endblock %}



